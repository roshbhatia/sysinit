#!/usr/bin/env bash
# Test script to simulate fzf-tab preview calls
# This helps debug what fzf-tab actually passes to the preview function

echo "=== FZF-TAB TEST SIMULATION ===" 

# Test different scenarios that fzf-tab might encounter
test_cases=(
    "README.md"
    "./modules"
    "/usr/bin/ls"
    "non-existent-file"
    ""
)

echo "Testing fzf-preview directly:"
for test_case in "${test_cases[@]}"; do
    echo "----------------------------------------"
    echo "Testing: '$test_case'"
    echo "----------------------------------------"
    if command -v fzf-preview &>/dev/null; then
        fzf-preview "$test_case" 2>&1 | head -10
    else
        echo "fzf-preview not found in PATH. Testing local script:"
        ./modules/home/configurations/utils/fzf-preview "$test_case" 2>&1 | head -10
    fi
    echo
done

echo "=== ENVIRONMENT SIMULATION ==="
echo "Simulating fzf-tab environment variables:"

# Simulate what fzf-tab might set
export realpath="README.md"
export word="README.md"
export desc="readme file"

echo "realpath='$realpath'"
echo "word='$word'" 
echo "desc='$desc'"
echo

echo "Testing debug script with simulated environment:"
if command -v fzf-tab-debug &>/dev/null; then
    fzf-tab-debug "$realpath" "$word" "$desc"
else
    echo "fzf-tab-debug not installed yet. Run darwin-rebuild first."
fi